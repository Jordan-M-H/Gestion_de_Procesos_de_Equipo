<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Procesos de Equipo - MVP</title>
    <style>
        /* === ESTILOS GENERALES === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        /* === HEADER === */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .role-selector {
            margin-top: 20px;
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .role-selector label {
            font-size: 1.1em;
            margin-right: 10px;
        }

        .role-selector select {
            padding: 8px 15px;
            font-size: 1em;
            border-radius: 5px;
            border: none;
            background: white;
            color: #333;
            cursor: pointer;
        }

        .current-role {
            display: inline-block;
            margin-left: 20px;
            padding: 5px 15px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            font-weight: bold;
        }

        /* === NAVEGACIÓN === */
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 3px solid #e9ecef;
        }

        .nav-tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            background: transparent;
            border: none;
            font-size: 1.1em;
            font-weight: 500;
            color: #6c757d;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-tab:hover {
            background: #e9ecef;
            color: #495057;
        }

        .nav-tab.active {
            color: #667eea;
            background: white;
        }

        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* === CONTENIDO === */
        .content {
            padding: 30px;
            min-height: 500px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* === FORMULARIOS === */
        .form-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .form-section h3 {
            color: #495057;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #495057;
            font-weight: 500;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        /* === BOTONES === */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* === LISTAS === */
        .list-section {
            margin-top: 30px;
        }

        .list-section h3 {
            color: #495057;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .item-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .item-card:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transform: translateX(5px);
        }

        .item-info h4 {
            color: #495057;
            margin-bottom: 5px;
        }

        .item-meta {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }

        .meta-tag {
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9em;
            font-weight: 500;
        }

        /* === COLORES DE COMPLEJIDAD === */
        .complexity-baja {
            background: #d4edda;
            color: #155724;
        }

        .complexity-media {
            background: #fff3cd;
            color: #856404;
        }

        .complexity-alta {
            background: #f8d7da;
            color: #721c24;
        }

        /* === TABLAS === */
        .table-container {
            overflow-x: auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        th, td {
            padding: 15px;
            text-align: left;
        }

        th {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.9em;
            letter-spacing: 0.5px;
        }

        tbody tr {
            border-bottom: 1px solid #e9ecef;
            transition: background 0.3s ease;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        /* === FILTROS === */
        .filters {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .filter-group {
            flex: 1;
        }

        /* === ESTADÍSTICAS === */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1em;
            opacity: 0.9;
        }

        /* === GRÁFICO === */
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }

        .chart-title {
            text-align: center;
            color: #495057;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        #chartCanvas {
            max-width: 100%;
            height: auto;
        }

        .chart-legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        /* === MENSAJES === */
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }

        /* === RESPONSIVE === */
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                flex-wrap: wrap;
            }

            .nav-tab {
                flex: 1 1 50%;
            }

            .filters {
                flex-direction: column;
            }

            .header h1 {
                font-size: 1.8em;
            }
        }

        /* === TOOLTIPS === */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9em;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* === ANIMACIÓN DE CARGA === */
        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header con selector de rol -->
        <div class="header">
            <h1>📋 Sistema de Gestión de Procesos de Equipo</h1>
            <p>Organiza, asigna y visualiza las tareas de tu equipo de manera eficiente</p>
            <div class="role-selector">
                <label for="roleSelect">Seleccionar Rol:</label>
                <select id="roleSelect">
                    <option value="lider">👑 Líder del Equipo (Acceso Completo)</option>
                    <option value="miembro">👤 Miembro del Equipo (Solo Lectura)</option>
                </select>
                <span class="current-role" id="currentRole">Rol: Líder</span>
            </div>
        </div>

        <!-- Navegación por pestañas -->
        <div class="nav-tabs">
            <button class="nav-tab active" data-tab="procesos">📝 Procesos</button>
            <button class="nav-tab" data-tab="miembros">👥 Miembros</button>
            <button class="nav-tab" data-tab="asignaciones">🔗 Asignaciones</button>
            <button class="nav-tab" data-tab="resumen">📊 Resumen y Gráficas</button>
        </div>

        <!-- Contenido principal -->
        <div class="content">
            <!-- Mensajes del sistema -->
            <div id="messageContainer"></div>

            <!-- Tab: Procesos -->
            <div id="procesos" class="tab-content active">
                <div class="form-section">
                    <h3>➕ Agregar Nuevo Proceso</h3>
                    <form id="procesoForm">
                        <div class="form-group">
                            <label for="procesoNombre">Nombre del Proceso:</label>
                            <input type="text" id="procesoNombre" required placeholder="Ej: Revisar documentación">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="procesoTiempo">Tiempo Efectivo (minutos):</label>
                                <input type="number" id="procesoTiempo" min="1" required placeholder="Ej: 30">
                            </div>
                            <div class="form-group">
                                <label for="procesoComplejidad">Nivel de Complejidad:</label>
                                <select id="procesoComplejidad" required>
                                    <option value="">Seleccionar...</option>
                                    <option value="baja">🟢 Baja</option>
                                    <option value="media">🟡 Media</option>
                                    <option value="alta">🔴 Alta</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" id="btnAgregarProceso">Agregar Proceso</button>
                    </form>
                </div>

                <div class="list-section">
                    <h3>📋 Procesos Existentes</h3>
                    <div id="procesosLista"></div>
                </div>
            </div>

            <!-- Tab: Miembros -->
            <div id="miembros" class="tab-content">
                <div class="form-section">
                    <h3>➕ Agregar Nuevo Miembro</h3>
                    <form id="miembroForm">
                        <div class="form-group">
                            <label for="miembroNombre">Nombre Completo:</label>
                            <input type="text" id="miembroNombre" required placeholder="Ej: Juan Pérez García">
                        </div>
                        <button type="submit" class="btn btn-primary" id="btnAgregarMiembro">Agregar Miembro</button>
                    </form>
                </div>

                <div class="list-section">
                    <h3>👥 Miembros del Equipo</h3>
                    <div id="miembrosLista"></div>
                </div>
            </div>

            <!-- Tab: Asignaciones -->
            <div id="asignaciones" class="tab-content">
                <div class="form-section">
                    <h3>🔗 Asignar Proceso a Miembro</h3>
                    <form id="asignacionForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="asignacionMiembro">Seleccionar Miembro:</label>
                                <select id="asignacionMiembro" required>
                                    <option value="">Seleccionar...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="asignacionProceso">Seleccionar Proceso:</label>
                                <select id="asignacionProceso" required>
                                    <option value="">Seleccionar...</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" id="btnAsignar">Asignar Proceso</button>
                    </form>
                </div>

                <div class="list-section">
                    <h3>📋 Asignaciones Actuales</h3>
                    <div id="asignacionesLista"></div>
                </div>
            </div>

            <!-- Tab: Resumen -->
            <div id="resumen" class="tab-content">
                <!-- Estadísticas -->
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-value" id="totalProcesos">0</div>
                        <div class="stat-label">Total Procesos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalMiembros">0</div>
                        <div class="stat-label">Total Miembros</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalAsignaciones">0</div>
                        <div class="stat-label">Total Asignaciones</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="tiempoTotal">0</div>
                        <div class="stat-label">Tiempo Total (min)</div>
                    </div>
                </div>

                <!-- Filtros -->
                <div class="filters">
                    <div class="filter-group">
                        <label for="filtroMiembro">Filtrar por Miembro:</label>
                        <select id="filtroMiembro">
                            <option value="">Todos los miembros</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="filtroComplejidad">Filtrar por Complejidad:</label>
                        <select id="filtroComplejidad">
                            <option value="">Todas las complejidades</option>
                            <option value="baja">🟢 Baja</option>
                            <option value="media">🟡 Media</option>
                            <option value="alta">🔴 Alta</option>
                        </select>
                    </div>
                </div>

                <!-- Tabla de resumen -->
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Proceso</th>
                                <th>Miembro Asignado</th>
                                <th>Tiempo (min)</th>
                                <th>Complejidad</th>
                            </tr>
                        </thead>
                        <tbody id="resumenTabla">
                            <tr>
                                <td colspan="4" style="text-align: center;">No hay asignaciones para mostrar</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Gráfico de barras -->
                <div class="chart-container">
                    <h3 class="chart-title">📊 Distribución de Tareas por Miembro</h3>
                    <canvas id="chartCanvas" width="800" height="400"></canvas>
                    <div class="chart-legend">
                        <div class="legend-item">
                            <div class="legend-color complexity-baja"></div>
                            <span>Complejidad Baja</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color complexity-media"></div>
                            <span>Complejidad Media</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color complexity-alta"></div>
                            <span>Complejidad Alta</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // PRINCIPIO SOLID: Single Responsibility
        // Cada clase tiene una única responsabilidad
        // ========================================

        // ====== MODELOS (Entidades del negocio) ======
        
        /**
         * Clase Proceso
         * Representa una tarea o proceso del equipo
         * Responsabilidad: Mantener los datos de un proceso
         */
        class Proceso {
            constructor(id, nombre, tiempoEfectivo, complejidad) {
                this.id = id;
                this.nombre = nombre;
                this.tiempoEfectivo = parseInt(tiempoEfectivo); // en minutos
                this.complejidad = complejidad; // 'baja', 'media', 'alta'
            }

            // Método para obtener el color según la complejidad
            getColorComplejidad() {
                const colores = {
                    'baja': '#28a745',
                    'media': '#ffc107',
                    'alta': '#dc3545'
                };
                return colores[this.complejidad] || '#6c757d';
            }

            // Método para obtener el emoji de complejidad
            getEmojiComplejidad() {
                const emojis = {
                    'baja': '🟢',
                    'media': '🟡',
                    'alta': '🔴'
                };
                return emojis[this.complejidad] || '⚪';
            }
        }

        /**
         * Clase Miembro
         * Representa un miembro del equipo
         * Responsabilidad: Mantener los datos de un miembro
         */
        class Miembro {
            constructor(id, nombre) {
                this.id = id;
                this.nombre = nombre;
            }
        }

        /**
         * Clase Asignacion
         * Representa la relación entre un miembro y un proceso
         * Responsabilidad: Mantener los datos de una asignación
         */
        class Asignacion {
            constructor(id, miembroId, procesoId) {
                this.id = id;
                this.miembroId = miembroId;
                this.procesoId = procesoId;
                this.fechaAsignacion = new Date().toISOString();
            }
        }

        // ====== SERVICIOS (Lógica de negocio) ======

        /**
         * StorageService
         * Responsabilidad: Manejar toda la persistencia de datos en localStorage
         * SOLID - S: Solo se encarga del almacenamiento
         */
        class StorageService {
            constructor() {
                this.prefix = 'teamProcessManager_'; // Prefijo para evitar colisiones
            }

            // Guardar datos en localStorage
            save(key, data) {
                try {
                    localStorage.setItem(this.prefix + key, JSON.stringify(data));
                    return true;
                } catch (error) {
                    console.error('Error al guardar en localStorage:', error);
                    return false;
                }
            }

            // Obtener datos de localStorage
            get(key) {
                try {
                    const data = localStorage.getItem(this.prefix + key);
                    return data ? JSON.parse(data) : null;
                } catch (error) {
                    console.error('Error al leer de localStorage:', error);
                    return null;
                }
            }

            // Eliminar datos de localStorage
            remove(key) {
                try {
                    localStorage.removeItem(this.prefix + key);
                    return true;
                } catch (error) {
                    console.error('Error al eliminar de localStorage:', error);
                    return false;
                }
            }

            // Limpiar todo el almacenamiento de la aplicación
            clear() {
                try {
                    const keys = Object.keys(localStorage);
                    keys.forEach(key => {
                        if (key.startsWith(this.prefix)) {
                            localStorage.removeItem(key);
                        }
                    });
                    return true;
                } catch (error) {
                    console.error('Error al limpiar localStorage:', error);
                    return false;
                }
            }
        }

        /**
         * ValidationService
         * Responsabilidad: Validar todos los datos de entrada
         * SOLID - S: Solo se encarga de validaciones
         */
        class ValidationService {
            // Validar nombre único
            validateUniqueName(name, existingNames) {
                return !existingNames.some(n => n.toLowerCase() === name.toLowerCase());
            }

            // Validar que el nombre no esté vacío
            validateNotEmpty(value) {
                return value && value.trim().length > 0;
            }

            // Validar tiempo mayor a 0
            validatePositiveNumber(value) {
                return !isNaN(value) && parseInt(value) > 0;
            }

            // Validar complejidad válida
            validateComplexity(value) {
                return ['baja', 'media', 'alta'].includes(value);
            }

            // Validar asignación única
            validateUniqueAssignment(miembroId, procesoId, existingAssignments) {
                return !existingAssignments.some(a => 
                    a.miembroId === miembroId && a.procesoId === procesoId
                );
            }
        }

        /**
         * DataManager
         * Responsabilidad: Gestionar todas las operaciones de datos
         * SOLID - D: Depende de abstracciones (servicios)
         */
        class DataManager {
            constructor(storageService, validationService) {
                this.storage = storageService;
                this.validator = validationService;
                this.procesos = [];
                this.miembros = [];
                this.asignaciones = [];
                this.loadData();
                this.initializeWithSampleData();
            }

            // Cargar datos desde localStorage
            loadData() {
                this.procesos = this.storage.get('procesos') || [];
                this.miembros = this.storage.get('miembros') || [];
                this.asignaciones = this.storage.get('asignaciones') || [];
            }

            // Guardar datos en localStorage
            saveData() {
                this.storage.save('procesos', this.procesos);
                this.storage.save('miembros', this.miembros);
                this.storage.save('asignaciones', this.asignaciones);
            }

            // Inicializar con datos de ejemplo si no hay datos
            initializeWithSampleData() {
                if (this.procesos.length === 0 && this.miembros.length === 0) {
                    // Datos de ejemplo - Procesos
                    this.addProceso('Revisar código', 45, 'media');
                    this.addProceso('Escribir documentación', 30, 'baja');
                    this.addProceso('Diseñar arquitectura', 120, 'alta');
                    this.addProceso('Testing unitario', 60, 'media');
                    this.addProceso('Reunión diaria', 15, 'baja');

                    // Datos de ejemplo - Miembros
                    this.addMiembro('Ana García López');
                    this.addMiembro('Carlos Rodríguez Pérez');
                    this.addMiembro('María Fernández Silva');
                    this.addMiembro('Juan Martínez González');

                    // Datos de ejemplo - Asignaciones
                    this.addAsignacion(this.miembros[0].id, this.procesos[0].id);
                    this.addAsignacion(this.miembros[0].id, this.procesos[1].id);
                    this.addAsignacion(this.miembros[1].id, this.procesos[2].id);
                    this.addAsignacion(this.miembros[2].id, this.procesos[3].id);
                    this.addAsignacion(this.miembros[3].id, this.procesos[4].id);
                    this.addAsignacion(this.miembros[1].id, this.procesos[3].id);
                }
            }

            // Generar ID único
            generateId() {
                return Date.now().toString() + Math.random().toString(36).substr(2, 9);
            }

            // === MÉTODOS PARA PROCESOS ===
            addProceso(nombre, tiempo, complejidad) {
                // Validaciones
                if (!this.validator.validateNotEmpty(nombre)) {
                    throw new Error('El nombre del proceso no puede estar vacío');
                }
                if (!this.validator.validateUniqueName(nombre, this.procesos.map(p => p.nombre))) {
                    throw new Error('Ya existe un proceso con ese nombre');
                }
                if (!this.validator.validatePositiveNumber(tiempo)) {
                    throw new Error('El tiempo debe ser mayor a 0');
                }
                if (!this.validator.validateComplexity(complejidad)) {
                    throw new Error('La complejidad debe ser baja, media o alta');
                }

                const proceso = new Proceso(this.generateId(), nombre, tiempo, complejidad);
                this.procesos.push(proceso);
                this.saveData();
                return proceso;
            }

            updateProceso(id, nombre, tiempo, complejidad) {
                const index = this.procesos.findIndex(p => p.id === id);
                if (index === -1) {
                    throw new Error('Proceso no encontrado');
                }

                // Validar nombre único (excepto el actual)
                const otherNames = this.procesos.filter(p => p.id !== id).map(p => p.nombre);
                if (!this.validator.validateUniqueName(nombre, otherNames)) {
                    throw new Error('Ya existe otro proceso con ese nombre');
                }

                this.procesos[index].nombre = nombre;
                this.procesos[index].tiempoEfectivo = parseInt(tiempo);
                this.procesos[index].complejidad = complejidad;
                this.saveData();
                return this.procesos[index];
            }

            deleteProceso(id) {
                // Verificar si hay asignaciones con este proceso
                const tieneAsignaciones = this.asignaciones.some(a => a.procesoId === id);
                if (tieneAsignaciones) {
                    throw new Error('No se puede eliminar un proceso con asignaciones activas');
                }

                this.procesos = this.procesos.filter(p => p.id !== id);
                this.saveData();
            }

            // === MÉTODOS PARA MIEMBROS ===
            addMiembro(nombre) {
                if (!this.validator.validateNotEmpty(nombre)) {
                    throw new Error('El nombre del miembro no puede estar vacío');
                }
                if (!this.validator.validateUniqueName(nombre, this.miembros.map(m => m.nombre))) {
                    throw new Error('Ya existe un miembro con ese nombre');
                }

                const miembro = new Miembro(this.generateId(), nombre);
                this.miembros.push(miembro);
                this.saveData();
                return miembro;
            }

            deleteMiembro(id) {
                // Verificar si hay asignaciones con este miembro
                const tieneAsignaciones = this.asignaciones.some(a => a.miembroId === id);
                if (tieneAsignaciones) {
                    throw new Error('No se puede eliminar un miembro con asignaciones activas');
                }

                this.miembros = this.miembros.filter(m => m.id !== id);
                this.saveData();
            }

            // === MÉTODOS PARA ASIGNACIONES ===
            addAsignacion(miembroId, procesoId) {
                if (!this.validator.validateUniqueAssignment(miembroId, procesoId, this.asignaciones)) {
                    throw new Error('Esta asignación ya existe');
                }

                const asignacion = new Asignacion(this.generateId(), miembroId, procesoId);
                this.asignaciones.push(asignacion);
                this.saveData();
                return asignacion;
            }

            deleteAsignacion(id) {
                this.asignaciones = this.asignaciones.filter(a => a.id !== id);
                this.saveData();
            }

            // === MÉTODOS DE CONSULTA ===
            getProcesoById(id) {
                return this.procesos.find(p => p.id === id);
            }

            getMiembroById(id) {
                return this.miembros.find(m => m.id === id);
            }

            getAsignacionesByMiembro(miembroId) {
                return this.asignaciones.filter(a => a.miembroId === miembroId);
            }

            getAsignacionesByProceso(procesoId) {
                return this.asignaciones.filter(a => a.procesoId === procesoId);
            }

            // Obtener resumen completo
            getResumenCompleto() {
                return this.asignaciones.map(a => {
                    const miembro = this.getMiembroById(a.miembroId);
                    const proceso = this.getProcesoById(a.procesoId);
                    return {
                        id: a.id,
                        miembroNombre: miembro ? miembro.nombre : 'N/A',
                        procesoNombre: proceso ? proceso.nombre : 'N/A',
                        tiempo: proceso ? proceso.tiempoEfectivo : 0,
                        complejidad: proceso ? proceso.complejidad : 'N/A'
                    };
                });
            }

            // Obtener estadísticas para gráficos
            getEstadisticasPorMiembro() {
                const stats = {};
                
                this.miembros.forEach(miembro => {
                    stats[miembro.nombre] = {
                        baja: 0,
                        media: 0,
                        alta: 0,
                        total: 0
                    };
                });

                this.asignaciones.forEach(asignacion => {
                    const miembro = this.getMiembroById(asignacion.miembroId);
                    const proceso = this.getProcesoById(asignacion.procesoId);
                    
                    if (miembro && proceso) {
                        stats[miembro.nombre][proceso.complejidad]++;
                        stats[miembro.nombre].total++;
                    }
                });

                return stats;
            }
        }

        /**
         * UIManager
         * Responsabilidad: Manejar toda la interfaz de usuario
         * SOLID - S: Solo maneja la UI
         * SOLID - O: Abierto para extensión (nuevas vistas)
         */
        class UIManager {
            constructor(dataManager) {
                this.dataManager = dataManager;
                this.currentRole = 'lider';
                this.currentTab = 'procesos';
                this.initializeEventListeners();
                this.updateAllViews();
            }

            // Inicializar todos los event listeners
            initializeEventListeners() {
                // Cambio de rol
                document.getElementById('roleSelect').addEventListener('change', (e) => {
                    this.setRole(e.target.value);
                });

                // Navegación por pestañas
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.switchTab(e.target.dataset.tab);
                    });
                });

                // Formulario de procesos
                document.getElementById('procesoForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleAddProceso();
                });

                // Formulario de miembros
                document.getElementById('miembroForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleAddMiembro();
                });

                // Formulario de asignaciones
                document.getElementById('asignacionForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleAddAsignacion();
                });

                // Filtros
                document.getElementById('filtroMiembro').addEventListener('change', () => {
                    this.updateResumenTable();
                });

                document.getElementById('filtroComplejidad').addEventListener('change', () => {
                    this.updateResumenTable();
                });
            }

            // Cambiar rol del usuario
            setRole(role) {
                this.currentRole = role;
                document.getElementById('currentRole').textContent = 
                    role === 'lider' ? 'Rol: Líder' : 'Rol: Miembro';
                
                // Habilitar/deshabilitar formularios según el rol
                const isLeader = role === 'lider';
                document.querySelectorAll('form button[type="submit"]').forEach(btn => {
                    btn.disabled = !isLeader;
                    btn.title = isLeader ? '' : 'Solo el líder puede realizar esta acción';
                });

                // Actualizar vistas
                this.updateAllViews();
                
                // Mostrar mensaje
                this.showMessage(
                    `Rol cambiado a: ${role === 'lider' ? 'Líder del Equipo' : 'Miembro del Equipo'}`,
                    role === 'lider' ? 'success' : 'warning'
                );
            }

            // Cambiar pestaña activa
            switchTab(tabName) {
                // Actualizar pestañas
                document.querySelectorAll('.nav-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

                // Actualizar contenido
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tabName).classList.add('active');

                this.currentTab = tabName;

                // Si es la pestaña de resumen, actualizar el gráfico
                if (tabName === 'resumen') {
                    this.updateChart();
                }
            }

            // === MANEJO DE PROCESOS ===
            handleAddProceso() {
                try {
                    const nombre = document.getElementById('procesoNombre').value;
                    const tiempo = document.getElementById('procesoTiempo').value;
                    const complejidad = document.getElementById('procesoComplejidad').value;

                    this.dataManager.addProceso(nombre, tiempo, complejidad);
                    
                    // Limpiar formulario
                    document.getElementById('procesoForm').reset();
                    
                    // Actualizar vistas
                    this.updateProcesosList();
                    this.updateSelectOptions();
                    this.updateStats();
                    
                    this.showMessage('✅ Proceso agregado exitosamente', 'success');
                } catch (error) {
                    this.showMessage('❌ ' + error.message, 'error');
                }
            }

            updateProcesosList() {
                const container = document.getElementById('procesosLista');
                const procesos = this.dataManager.procesos;
                
                if (procesos.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #6c757d;">No hay procesos registrados</p>';
                    return;
                }

                container.innerHTML = procesos.map(proceso => `
                    <div class="item-card">
                        <div class="item-info">
                            <h4>${proceso.nombre}</h4>
                            <div class="item-meta">
                                <span class="meta-tag">⏱️ ${proceso.tiempoEfectivo} min</span>
                                <span class="meta-tag complexity-${proceso.complejidad}">
                                    ${proceso.getEmojiComplejidad()} ${proceso.complejidad.toUpperCase()}
                                </span>
                            </div>
                        </div>
                        ${this.currentRole === 'lider' ? `
                            <button class="btn btn-danger" onclick="app.uiManager.deleteProceso('${proceso.id}')">
                                Eliminar
                            </button>
                        ` : ''}
                    </div>
                `).join('');
            }

            deleteProceso(id) {
                if (!confirm('¿Está seguro de eliminar este proceso?')) return;
                
                try {
                    this.dataManager.deleteProceso(id);
                    this.updateProcesosList();
                    this.updateSelectOptions();
                    this.updateStats();
                    this.showMessage('✅ Proceso eliminado', 'success');
                } catch (error) {
                    this.showMessage('❌ ' + error.message, 'error');
                }
            }

            // === MANEJO DE MIEMBROS ===
            handleAddMiembro() {
                try {
                    const nombre = document.getElementById('miembroNombre').value;
                    
                    this.dataManager.addMiembro(nombre);
                    
                    // Limpiar formulario
                    document.getElementById('miembroForm').reset();
                    
                    // Actualizar vistas
                    this.updateMiembrosList();
                    this.updateSelectOptions();
                    this.updateStats();
                    
                    this.showMessage('✅ Miembro agregado exitosamente', 'success');
                } catch (error) {
                    this.showMessage('❌ ' + error.message, 'error');
                }
            }

            updateMiembrosList() {
                const container = document.getElementById('miembrosLista');
                const miembros = this.dataManager.miembros;
                
                if (miembros.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #6c757d;">No hay miembros registrados</p>';
                    return;
                }

                container.innerHTML = miembros.map(miembro => {
                    const asignaciones = this.dataManager.getAsignacionesByMiembro(miembro.id);
                    return `
                        <div class="item-card">
                            <div class="item-info">
                                <h4>👤 ${miembro.nombre}</h4>
                                <div class="item-meta">
                                    <span class="meta-tag">📋 ${asignaciones.length} tareas asignadas</span>
                                </div>
                            </div>
                            ${this.currentRole === 'lider' ? `
                                <button class="btn btn-danger" onclick="app.uiManager.deleteMiembro('${miembro.id}')">
                                    Eliminar
                                </button>
                            ` : ''}
                        </div>
                    `;
                }).join('');
            }

            deleteMiembro(id) {
                if (!confirm('¿Está seguro de eliminar este miembro?')) return;
                
                try {
                    this.dataManager.deleteMiembro(id);
                    this.updateMiembrosList();
                    this.updateSelectOptions();
                    this.updateStats();
                    this.showMessage('✅ Miembro eliminado', 'success');
                } catch (error) {
                    this.showMessage('❌ ' + error.message, 'error');
                }
            }

            // === MANEJO DE ASIGNACIONES ===
            handleAddAsignacion() {
                try {
                    const miembroId = document.getElementById('asignacionMiembro').value;
                    const procesoId = document.getElementById('asignacionProceso').value;
                    
                    this.dataManager.addAsignacion(miembroId, procesoId);
                    
                    // Limpiar formulario
                    document.getElementById('asignacionForm').reset();
                    
                    // Actualizar vistas
                    this.updateAsignacionesList();
                    this.updateResumenTable();
                    this.updateStats();
                    this.updateChart();
                    
                    this.showMessage('✅ Asignación creada exitosamente', 'success');
                } catch (error) {
                    this.showMessage('❌ ' + error.message, 'error');
                }
            }

            updateAsignacionesList() {
                const container = document.getElementById('asignacionesLista');
                const asignaciones = this.dataManager.asignaciones;
                
                if (asignaciones.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #6c757d;">No hay asignaciones registradas</p>';
                    return;
                }

                // Agrupar asignaciones por miembro
                const asignacionesPorMiembro = {};
                asignaciones.forEach(asignacion => {
                    const miembro = this.dataManager.getMiembroById(asignacion.miembroId);
                    if (miembro) {
                        if (!asignacionesPorMiembro[miembro.nombre]) {
                            asignacionesPorMiembro[miembro.nombre] = [];
                        }
                        asignacionesPorMiembro[miembro.nombre].push(asignacion);
                    }
                });

                container.innerHTML = Object.entries(asignacionesPorMiembro).map(([nombreMiembro, asignaciones]) => {
                    return `
                        <div style="margin-bottom: 30px;">
                            <h4 style="color: #495057; margin-bottom: 15px;">👤 ${nombreMiembro}</h4>
                            ${asignaciones.map(asignacion => {
                                const proceso = this.dataManager.getProcesoById(asignacion.procesoId);
                                if (!proceso) return '';
                                
                                return `
                                    <div class="item-card" style="margin-left: 20px;">
                                        <div class="item-info">
                                            <h5>${proceso.nombre}</h5>
                                            <div class="item-meta">
                                                <span class="meta-tag">⏱️ ${proceso.tiempoEfectivo} min</span>
                                                <span class="meta-tag complexity-${proceso.complejidad}">
                                                    ${proceso.getEmojiComplejidad()} ${proceso.complejidad.toUpperCase()}
                                                </span>
                                            </div>
                                        </div>
                                        ${this.currentRole === 'lider' ? `
                                            <button class="btn btn-danger" onclick="app.uiManager.deleteAsignacion('${asignacion.id}')">
                                                Desasignar
                                            </button>
                                        ` : ''}
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                }).join('');
            }

            deleteAsignacion(id) {
                if (!confirm('¿Está seguro de desasignar este proceso?')) return;
                
                this.dataManager.deleteAsignacion(id);
                this.updateAsignacionesList();
                this.updateResumenTable();
                this.updateStats();
                this.updateChart();
                this.showMessage('✅ Asignación eliminada', 'success');
            }

            // === ACTUALIZACIÓN DE SELECTS ===
            updateSelectOptions() {
                // Actualizar select de miembros
                const miembroSelect = document.getElementById('asignacionMiembro');
                const filtroMiembroSelect = document.getElementById('filtroMiembro');
                
                const miembrosOptions = '<option value="">Seleccionar...</option>' + 
                    this.dataManager.miembros.map(m => 
                        `<option value="${m.id}">${m.nombre}</option>`
                    ).join('');
                
                miembroSelect.innerHTML = miembrosOptions;
                
                filtroMiembroSelect.innerHTML = '<option value="">Todos los miembros</option>' + 
                    this.dataManager.miembros.map(m => 
                        `<option value="${m.id}">${m.nombre}</option>`
                    ).join('');

                // Actualizar select de procesos
                const procesoSelect = document.getElementById('asignacionProceso');
                procesoSelect.innerHTML = '<option value="">Seleccionar...</option>' + 
                    this.dataManager.procesos.map(p => 
                        `<option value="${p.id}">${p.nombre} (${p.complejidad})</option>`
                    ).join('');
            }

            // === TABLA DE RESUMEN ===
            updateResumenTable() {
                const tbody = document.getElementById('resumenTabla');
                const filtroMiembro = document.getElementById('filtroMiembro').value;
                const filtroComplejidad = document.getElementById('filtroComplejidad').value;
                
                let resumen = this.dataManager.getResumenCompleto();
                
                // Aplicar filtros
                if (filtroMiembro) {
                    const miembro = this.dataManager.getMiembroById(filtroMiembro);
                    if (miembro) {
                        resumen = resumen.filter(r => r.miembroNombre === miembro.nombre);
                    }
                }
                
                if (filtroComplejidad) {
                    resumen = resumen.filter(r => r.complejidad === filtroComplejidad);
                }
                
                if (resumen.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="4" style="text-align: center;">No hay asignaciones que coincidan con los filtros</td></tr>';
                    return;
                }

                tbody.innerHTML = resumen.map(r => {
                    const complejidadClass = `complexity-${r.complejidad}`;
                    const emoji = r.complejidad === 'baja' ? '🟢' : 
                                 r.complejidad === 'media' ? '🟡' : '🔴';
                    
                    return `
                        <tr>
                            <td>${r.procesoNombre}</td>
                            <td>${r.miembroNombre}</td>
                            <td>${r.tiempo} min</td>
                            <td><span class="meta-tag ${complejidadClass}">${emoji} ${r.complejidad.toUpperCase()}</span></td>
                        </tr>
                    `;
                }).join('');
            }

            // === ESTADÍSTICAS ===
            updateStats() {
                document.getElementById('totalProcesos').textContent = this.dataManager.procesos.length;
                document.getElementById('totalMiembros').textContent = this.dataManager.miembros.length;
                document.getElementById('totalAsignaciones').textContent = this.dataManager.asignaciones.length;
                
                // Calcular tiempo total
                const tiempoTotal = this.dataManager.asignaciones.reduce((total, asignacion) => {
                    const proceso = this.dataManager.getProcesoById(asignacion.procesoId);
                    return total + (proceso ? proceso.tiempoEfectivo : 0);
                }, 0);
                
                document.getElementById('tiempoTotal').textContent = tiempoTotal;
            }

            // === GRÁFICO DE BARRAS ===
            updateChart() {
                const canvas = document.getElementById('chartCanvas');
                const ctx = canvas.getContext('2d');
                const stats = this.dataManager.getEstadisticasPorMiembro();
                
                // Limpiar canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const miembros = Object.keys(stats);
                if (miembros.length === 0) {
                    ctx.fillStyle = '#6c757d';
                    ctx.font = '16px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('No hay datos para mostrar', canvas.width / 2, canvas.height / 2);
                    return;
                }

                // Configuración del gráfico
                const chartPadding = 40;
                const barWidth = (canvas.width - chartPadding * 2) / (miembros.length * 4);
                const maxValue = Math.max(...miembros.map(m => stats[m].total));
                const chartHeight = canvas.height - chartPadding * 2;

                // Colores para las complejidades
                const colors = {
                    baja: '#28a745',
                    media: '#ffc107',
                    alta: '#dc3545'
                };

                // Dibujar ejes
                ctx.strokeStyle = '#dee2e6';
                ctx.lineWidth = 2;
                
                // Eje Y
                ctx.beginPath();
                ctx.moveTo(chartPadding, chartPadding);
                ctx.lineTo(chartPadding, canvas.height - chartPadding);
                ctx.stroke();
                
                // Eje X
                ctx.beginPath();
                ctx.moveTo(chartPadding, canvas.height - chartPadding);
                ctx.lineTo(canvas.width - chartPadding, canvas.height - chartPadding);
                ctx.stroke();

                // Dibujar barras
                miembros.forEach((miembro, index) => {
                    const x = chartPadding + (index * barWidth * 4) + barWidth;
                    const memberStats = stats[miembro];
                    
                    // Barra de complejidad baja
                    const altoBaja = (memberStats.baja / maxValue) * chartHeight * 0.8;
                    ctx.fillStyle = colors.baja;
                    ctx.fillRect(x, canvas.height - chartPadding - altoBaja, barWidth * 0.8, altoBaja);
                    
                    // Barra de complejidad media
                    const altoMedia = (memberStats.media / maxValue) * chartHeight * 0.8;
                    ctx.fillStyle = colors.media;
                    ctx.fillRect(x + barWidth, canvas.height - chartPadding - altoMedia, barWidth * 0.8, altoMedia);
                    
                    // Barra de complejidad alta
                    const altoAlta = (memberStats.alta / maxValue) * chartHeight * 0.8;
                    ctx.fillStyle = colors.alta;
                    ctx.fillRect(x + barWidth * 2, canvas.height - chartPadding - altoAlta, barWidth * 0.8, altoAlta);
                    
                    // Etiqueta del miembro
                    ctx.fillStyle = '#495057';
                    ctx.font = '12px Arial';
                    ctx.textAlign = 'center';
                    ctx.save();
                    ctx.translate(x + barWidth * 1.5, canvas.height - chartPadding + 20);
                    ctx.rotate(-0.2);
                    ctx.fillText(miembro, 0, 0);
                    ctx.restore();
                    
                    // Valores encima de las barras
                    ctx.font = '10px Arial';
                    ctx.fillStyle = '#495057';
                    ctx.textAlign = 'center';
                    
                    if (memberStats.baja > 0) {
                        ctx.fillText(memberStats.baja, x + barWidth * 0.4, canvas.height - chartPadding - altoBaja - 5);
                    }
                    if (memberStats.media > 0) {
                        ctx.fillText(memberStats.media, x + barWidth * 1.4, canvas.height - chartPadding - altoMedia - 5);
                    }
                    if (memberStats.alta > 0) {
                        ctx.fillText(memberStats.alta, x + barWidth * 2.4, canvas.height - chartPadding - altoAlta - 5);
                    }
                });

                // Título del eje Y
                ctx.save();
                ctx.translate(15, canvas.height / 2);
                ctx.rotate(-Math.PI / 2);
                ctx.fillStyle = '#495057';
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Número de Tareas', 0, 0);
                ctx.restore();

                // Escala del eje Y
                ctx.fillStyle = '#6c757d';
                ctx.font = '10px Arial';
                ctx.textAlign = 'right';
                for (let i = 0; i <= 5; i++) {
                    const y = canvas.height - chartPadding - (i * chartHeight / 5);
                    const value = Math.round((i * maxValue) / 5);
                    ctx.fillText(value, chartPadding - 5, y + 3);
                    
                    // Líneas de cuadrícula
                    if (i > 0) {
                        ctx.strokeStyle = '#e9ecef';
                        ctx.lineWidth = 1;
                        ctx.beginPath();
                        ctx.moveTo(chartPadding, y);
                        ctx.lineTo(canvas.width - chartPadding, y);
                        ctx.stroke();
                    }
                }
            }

            // === MENSAJES AL USUARIO ===
            showMessage(message, type = 'info') {
                const container = document.getElementById('messageContainer');
                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${type}`;
                alertDiv.textContent = message;
                
                container.innerHTML = '';
                container.appendChild(alertDiv);
                
                // Auto-ocultar después de 5 segundos
                setTimeout(() => {
                    alertDiv.style.opacity = '0';
                    setTimeout(() => {
                        if (alertDiv.parentNode) {
                            alertDiv.parentNode.removeChild(alertDiv);
                        }
                    }, 300);
                }, 5000);
            }

            // === ACTUALIZAR TODAS LAS VISTAS ===
            updateAllViews() {
                this.updateProcesosList();
                this.updateMiembrosList();
                this.updateAsignacionesList();
                this.updateSelectOptions();
                this.updateResumenTable();
                this.updateStats();
                this.updateChart();
            }
        }

        /**
         * ChartManager
         * Responsabilidad: Manejar la creación y actualización de gráficos
         * SOLID - S: Solo se encarga de los gráficos
         */
        class ChartManager {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
            }

            drawBarChart(data, options = {}) {
                // Implementación del gráfico de barras
                // Esta clase podría expandirse con más tipos de gráficos
            }

            clear() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
            }
        }

        /**
         * Application
         * Clase principal que coordina toda la aplicación
         * SOLID - D: Depende de abstracciones, no de implementaciones concretas
         */
        class Application {
            constructor() {
                // Inicializar servicios
                this.storageService = new StorageService();
                this.validationService = new ValidationService();
                
                // Inicializar gestores
                this.dataManager = new DataManager(this.storageService, this.validationService);
                this.uiManager = new UIManager(this.dataManager);
                
                console.log('🚀 Aplicación inicializada correctamente');
                console.log('📋 Procesos cargados:', this.dataManager.procesos.length);
                console.log('👥 Miembros cargados:', this.dataManager.miembros.length);
                console.log('🔗 Asignaciones cargadas:', this.dataManager.asignaciones.length);
            }

            // Método para reiniciar la aplicación
            reset() {
                if (confirm('¿Está seguro de reiniciar toda la aplicación? Se perderán todos los datos.')) {
                    this.storageService.clear();
                    location.reload();
                }
            }

            // Método para exportar datos (futuras mejoras)
            exportData() {
                const data = {
                    procesos: this.dataManager.procesos,
                    miembros: this.dataManager.miembros,
                    asignaciones: this.dataManager.asignaciones,
                    exportDate: new Date().toISOString()
                };
                
                const json = JSON.stringify(data, null, 2);
                const blob = new Blob([json], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = 'team_process_backup_' + new Date().getTime() + '.json';
                a.click();
                
                URL.revokeObjectURL(url);
                console.log('✅ Datos exportados correctamente');
            }

            // Método para importar datos (futuras mejoras)
            importData(jsonData) {
                try {
                    const data = JSON.parse(jsonData);
                    
                    // Validar estructura de datos
                    if (!data.procesos || !data.miembros || !data.asignaciones) {
                        throw new Error('Formato de datos inválido');
                    }
                    
                    // Cargar datos
                    this.dataManager.procesos = data.procesos;
                    this.dataManager.miembros = data.miembros;
                    this.dataManager.asignaciones = data.asignaciones;
                    
                    // Guardar en localStorage
                    this.dataManager.saveData();
                    
                    // Actualizar UI
                    this.uiManager.updateAllViews();
                    
                    console.log('✅ Datos importados correctamente');
                    return true;
                } catch (error) {
                    console.error('❌ Error al importar datos:', error);
                    return false;
                }
            }
        }

        // ========================================
        // INICIALIZACIÓN DE LA APLICACIÓN
        // ========================================
        
        let app;

        // Esperar a que el DOM esté completamente cargado
        document.addEventListener('DOMContentLoaded', () => {
            try {
                // Crear instancia de la aplicación
                app = new Application();
                
                // Hacer la aplicación accesible globalmente para debugging
                window.app = app;
                
                // Mostrar mensaje de bienvenida
                app.uiManager.showMessage(
                    '👋 ¡Bienvenido al Sistema de Gestión de Procesos! Los datos se guardan automáticamente en tu navegador.',
                    'success'
                );

                // Agregar atajos de teclado (opcional)
                document.addEventListener('keydown', (e) => {
                    // Ctrl+E para exportar
                    if (e.ctrlKey && e.key === 'e') {
                        e.preventDefault();
                        app.exportData();
                    }
                    
                    // Ctrl+Shift+R para reiniciar (con confirmación)
                    if (e.ctrlKey && e.shiftKey && e.key === 'R') {
                        e.preventDefault();
                        app.reset();
                    }
                });

                console.log('====================================');
                console.log('   APLICACIÓN CARGADA CON ÉXITO    ');
                console.log('====================================');
                console.log('Instrucciones de uso:');
                console.log('1. Selecciona tu rol (Líder o Miembro)');
                console.log('2. Como Líder puedes crear, editar y eliminar');
                console.log('3. Como Miembro solo puedes ver la información');
                console.log('4. Los datos se guardan automáticamente');
                console.log('');
                console.log('Atajos de teclado:');
                console.log('- Ctrl+E: Exportar datos');
                console.log('- Ctrl+Shift+R: Reiniciar aplicación');
                console.log('====================================');
                
            } catch (error) {
                console.error('Error crítico al inicializar la aplicación:', error);
                alert('Error al cargar la aplicación. Por favor, recarga la página.');
            }
        });

        // ========================================
        // PRINCIPIOS SOLID APLICADOS:
        // ========================================
        /*
        1. Single Responsibility (S):
           - Cada clase tiene una única responsabilidad
           - StorageService: Solo maneja almacenamiento
           - ValidationService: Solo maneja validaciones
           - UIManager: Solo maneja la interfaz
           - DataManager: Solo maneja la lógica de negocio

        2. Open/Closed (O):
           - Las clases están abiertas para extensión
           - Se pueden agregar nuevos tipos de gráficos sin modificar ChartManager
           - Se pueden agregar nuevas validaciones sin modificar ValidationService

        3. Liskov Substitution (L):
           - Las clases derivadas pueden sustituir a sus clases base
           - Cualquier servicio de almacenamiento que implemente los mismos métodos puede reemplazar StorageService

        4. Interface Segregation (I):
           - Cada clase tiene métodos específicos y bien definidos
           - No hay interfaces "gordas" con métodos innecesarios

        5. Dependency Inversion (D):
           - Las clases de alto nivel (Application, DataManager) dependen de abstracciones
           - No dependen directamente de implementaciones concretas
           - Esto permite cambiar fácilmente las implementaciones
        */

        // ========================================
        // ESTRUCTURA POO APLICADA:
        // ========================================
        /*
        - Encapsulación: Cada clase encapsula sus datos y comportamiento
        - Herencia: Podría aplicarse en futuras extensiones
        - Polimorfismo: Los métodos pueden ser sobrescritos en clases derivadas
        - Abstracción: Se ocultan los detalles de implementación
        */
    </script>
</body>
</html>